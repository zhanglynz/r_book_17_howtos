<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R tips: 17 HOWTO’s with examples for data analysts</title>
  <meta name="description" content="R tips: 17 HOWTO’s with examples for data analysts">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R tips: 17 HOWTO’s with examples for data analysts" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R tips: 17 HOWTO’s with examples for data analysts" />
  
  
  

<meta name="author" content="Lingyun Zhang">


<meta name="date" content="2019-03-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="how-to-tally.html">
<link rel="next" href="how-to-plot-data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="how-to-organize-a-project-folder.html"><a href="how-to-organize-a-project-folder.html"><i class="fa fa-check"></i><b>1</b> How to organize a project folder</a></li>
<li class="chapter" data-level="2" data-path="how-to-read-data-into-r.html"><a href="how-to-read-data-into-r.html"><i class="fa fa-check"></i><b>2</b> How to read data into <strong>R</strong></a></li>
<li class="chapter" data-level="3" data-path="how-to-explore-a-new-data-set.html"><a href="how-to-explore-a-new-data-set.html"><i class="fa fa-check"></i><b>3</b> How to explore a “new” data set</a></li>
<li class="chapter" data-level="4" data-path="how-to-deal-with-nas.html"><a href="how-to-deal-with-nas.html"><i class="fa fa-check"></i><b>4</b> How to deal with NA’s</a></li>
<li class="chapter" data-level="5" data-path="how-to-deal-with-empty-spaces.html"><a href="how-to-deal-with-empty-spaces.html"><i class="fa fa-check"></i><b>5</b> How to deal with empty spaces</a><ul>
<li class="chapter" data-level="5.1" data-path="how-to-deal-with-empty-spaces.html"><a href="how-to-deal-with-empty-spaces.html#empty-spaces-in-variable-names"><i class="fa fa-check"></i><b>5.1</b> Empty spaces in variable names</a></li>
<li class="chapter" data-level="5.2" data-path="how-to-deal-with-empty-spaces.html"><a href="how-to-deal-with-empty-spaces.html#empty-spaces-in-variable-values"><i class="fa fa-check"></i><b>5.2</b> Empty spaces in variable values</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="how-to-do-simple-re-coding.html"><a href="how-to-do-simple-re-coding.html"><i class="fa fa-check"></i><b>6</b> How to do simple re-coding</a></li>
<li class="chapter" data-level="7" data-path="how-to-create-contingency-tables.html"><a href="how-to-create-contingency-tables.html"><i class="fa fa-check"></i><b>7</b> How to create contingency tables</a></li>
<li class="chapter" data-level="8" data-path="how-to-tally.html"><a href="how-to-tally.html"><i class="fa fa-check"></i><b>8</b> How to tally</a></li>
<li class="chapter" data-level="9" data-path="how-to-join-two-data-tables.html"><a href="how-to-join-two-data-tables.html"><i class="fa fa-check"></i><b>9</b> How to join two data tables</a></li>
<li class="chapter" data-level="10" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html"><i class="fa fa-check"></i><b>10</b> How to plot data</a><ul>
<li class="chapter" data-level="10.1" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-basic-bar-charts"><i class="fa fa-check"></i><b>10.1</b> Creating basic bar charts</a></li>
<li class="chapter" data-level="10.2" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-side-by-side-and-stacked-bar-charts"><i class="fa fa-check"></i><b>10.2</b> Creating side-by-side and stacked bar charts</a></li>
<li class="chapter" data-level="10.3" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-back-to-back-bar-charts"><i class="fa fa-check"></i><b>10.3</b> Creating back-to-back bar charts</a></li>
<li class="chapter" data-level="10.4" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-pareto-charts"><i class="fa fa-check"></i><b>10.4</b> Creating Pareto charts</a></li>
<li class="chapter" data-level="10.5" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-lollipop-charts"><i class="fa fa-check"></i><b>10.5</b> Creating lollipop charts</a></li>
<li class="chapter" data-level="10.6" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-treemaps"><i class="fa fa-check"></i><b>10.6</b> Creating treemaps</a></li>
<li class="chapter" data-level="10.7" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-scatter-plots"><i class="fa fa-check"></i><b>10.7</b> Creating scatter plots</a></li>
<li class="chapter" data-level="10.8" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-side-by-side-box-plots"><i class="fa fa-check"></i><b>10.8</b> Creating side-by-side box plots</a></li>
<li class="chapter" data-level="10.9" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-grid-plots"><i class="fa fa-check"></i><b>10.9</b> Creating grid plots</a></li>
<li class="chapter" data-level="10.10" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-a-simple-pca-plot"><i class="fa fa-check"></i><b>10.10</b> Creating a simple PCA plot</a></li>
<li class="chapter" data-level="10.11" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#creating-time-series-plots"><i class="fa fa-check"></i><b>10.11</b> Creating time series plots</a></li>
<li class="chapter" data-level="10.12" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#showing-pop-ups"><i class="fa fa-check"></i><b>10.12</b> Showing pop-up’s</a></li>
<li class="chapter" data-level="10.13" data-path="how-to-plot-data.html"><a href="how-to-plot-data.html#putting-plots-in-one-panel"><i class="fa fa-check"></i><b>10.13</b> Putting plots in one panel</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="how-to-create-a-dynamic-report.html"><a href="how-to-create-a-dynamic-report.html"><i class="fa fa-check"></i><b>11</b> How to create a dynamic report</a></li>
<li class="chapter" data-level="12" data-path="how-to-learn-shiny.html"><a href="how-to-learn-shiny.html"><i class="fa fa-check"></i><b>12</b> How to learn Shiny</a></li>
<li class="chapter" data-level="13" data-path="how-to-make-a-simple-data-dictionary.html"><a href="how-to-make-a-simple-data-dictionary.html"><i class="fa fa-check"></i><b>13</b> How to make a simple data dictionary</a></li>
<li class="chapter" data-level="14" data-path="how-to-check-code-efficiency.html"><a href="how-to-check-code-efficiency.html"><i class="fa fa-check"></i><b>14</b> How to check code efficiency</a></li>
<li class="chapter" data-level="15" data-path="how-to-create-a-package.html"><a href="how-to-create-a-package.html"><i class="fa fa-check"></i><b>15</b> How to create a package</a><ul>
<li class="chapter" data-level="15.1" data-path="how-to-create-a-package.html"><a href="how-to-create-a-package.html#what-is-an-r-package"><i class="fa fa-check"></i><b>15.1</b> What is an R package?</a></li>
<li class="chapter" data-level="15.2" data-path="how-to-create-a-package.html"><a href="how-to-create-a-package.html#two-handy-tools"><i class="fa fa-check"></i><b>15.2</b> Two handy tools</a></li>
<li class="chapter" data-level="15.3" data-path="how-to-create-a-package.html"><a href="how-to-create-a-package.html#the-procedure"><i class="fa fa-check"></i><b>15.3</b> The procedure</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="how-to-put-n-things-in-m-boxes.html"><a href="how-to-put-n-things-in-m-boxes.html"><i class="fa fa-check"></i><b>16</b> How to put <em>n</em> things in <em>m</em> boxes</a></li>
<li class="chapter" data-level="17" data-path="how-to-restore-lost-zeros.html"><a href="how-to-restore-lost-zeros.html"><i class="fa fa-check"></i><b>17</b> How to restore lost zeros</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R tips: 17 HOWTO’s with examples for data analysts</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="how-to-join-two-data-tables" class="section level1">
<h1><span class="header-section-number">9</span> How to join two data tables</h1>
<p>In my opinion, the need to join two data tables together, is one of indicators (of course there are others) that we are dealing with complex data analysis. In practice, sometimes we may need to join many, say five, or even ten tables together. Hadley Wickham’s <strong>dplyr</strong> package provides <strong>left_join()</strong>, <strong>right_join()</strong>, <strong>inner_join()</strong>, <strong>full_join()</strong>, <strong>semi_join()</strong> and <strong>anti_join()</strong>; among them, the most useful one probably is <strong>left_join()</strong>. Let me quote a couple of sentences from <em><a href="http://r4ds.had.co.nz/relational-data.html">R for Data Science</a></em> (by Garrett Grolemund and Hadley Wickham),</p>
<blockquote>
<p>The most commonly used join is the left join: you use this whenever you look up additional data from another table, because it preserves the original observations even when there isn’t a match. The left join should be your default join: use it unless you have a strong reason to prefer one of the others.</p>
</blockquote>
<p>The syntax for <strong>left_join()</strong> is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">left_join</span>(table_<span class="dv">1</span>, table_<span class="dv">2</span>, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;ID_1&quot;</span> =<span class="st"> &quot;ID_2&quot;</span>))</code></pre></div>
<p>The key point to keep in mind is that table_1 is to the <strong>left</strong> of table_2, which means table_1 is the <strong>main</strong> table, or to be more exact, which means <strong>all the rows and columns of table_1 will be kept</strong>.</p>
<p>Let’s have an example.</p>
<p>Example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())

<span class="co"># load packages</span>
<span class="kw">library</span>(dplyr)

<span class="co"># create a fake data sets</span>
table_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">ID_1 =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">x =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each =</span> <span class="dv">2</span>))
table_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">ID_2 =</span> <span class="kw">c</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], LETTERS[<span class="dv">7</span><span class="op">:</span><span class="dv">8</span>], <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)

<span class="co"># join tables 1 and 2</span>
table_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">left_join</span>(table_<span class="dv">1</span>, table_<span class="dv">2</span>, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;ID_1&quot;</span> =<span class="st"> &quot;ID_2&quot;</span>))

<span class="co"># shwo the three tables</span>
<span class="kw">list</span>(table_<span class="dv">1</span>, table_<span class="dv">2</span>, table_<span class="dv">3</span>)</code></pre></div>
<pre><code>## [[1]]
## # A tibble: 6 x 2
##   ID_1      x
##   &lt;chr&gt; &lt;int&gt;
## 1 A         1
## 2 B         1
## 3 C         2
## 4 D         2
## 5 E         3
## 6 F         3
## 
## [[2]]
## # A tibble: 7 x 2
##   ID_2      y
##   &lt;chr&gt; &lt;int&gt;
## 1 A         1
## 2 B         2
## 3 C         3
## 4 G         4
## 5 H         5
## 6 A         6
## 7 B         7
## 
## [[3]]
## # A tibble: 8 x 3
##   ID_1      x     y
##   &lt;chr&gt; &lt;int&gt; &lt;int&gt;
## 1 A         1     1
## 2 A         1     6
## 3 B         1     2
## 4 B         1     7
## 5 C         2     3
## 6 D         2    NA
## 7 E         3    NA
## 8 F         3    NA</code></pre>
<p>Exercises.</p>
<ol style="list-style-type: decimal">
<li><p>Redo the above Example to recreate table_3 but using <strong>right_join</strong>.</p></li>
<li><p>Try <strong>inner_join()</strong> and <strong>semi_join()</strong> on table_1 and table_2 in the above example, and observe the difference between the two resulted tables.</p></li>
<li><p>Try <strong>full_join()</strong> on table_1 and table_2 in the above example.</p></li>
<li><p>Try <strong>anti_join()</strong> on table_1 and table_2 in the above example.</p></li>
</ol>
<p>Answer to the exercises:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())

<span class="co"># load packages</span>
<span class="kw">library</span>(dplyr)

<span class="co"># create a fake data sets</span>
table_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">ID_1 =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">x =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each =</span> <span class="dv">2</span>))
table_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">ID_2 =</span> <span class="kw">c</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], LETTERS[<span class="dv">7</span><span class="op">:</span><span class="dv">8</span>], <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)

<span class="co"># Exercise 1</span>
table_<span class="dv">3</span> &lt;-<span class="st"> </span>
<span class="st">  </span>table_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">right_join</span>(table_<span class="dv">1</span>, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;ID_2&quot;</span> =<span class="st"> &quot;ID_1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># change the order of columns</span>
<span class="st">  </span><span class="kw">select</span>(ID_<span class="dv">2</span>, x, y)

<span class="co"># Exercise 2</span>
table_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">inner_join</span>(table_<span class="dv">1</span>, table_<span class="dv">2</span>,  <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;ID_1&quot;</span> =<span class="st"> &quot;ID_2&quot;</span>))
table_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">semi_join</span>(table_<span class="dv">1</span>, table_<span class="dv">2</span>,  <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;ID_1&quot;</span> =<span class="st"> &quot;ID_2&quot;</span>))

<span class="co"># Exercise 3</span>
table_<span class="dv">6</span> &lt;-<span class="st"> </span><span class="kw">full_join</span>(table_<span class="dv">1</span>, table_<span class="dv">2</span>,  <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;ID_1&quot;</span> =<span class="st"> &quot;ID_2&quot;</span>))

<span class="co"># Exercise 4</span>
table_<span class="dv">7</span> &lt;-<span class="st"> </span><span class="kw">anti_join</span>(table_<span class="dv">1</span>, table_<span class="dv">2</span>,  <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;ID_1&quot;</span> =<span class="st"> &quot;ID_2&quot;</span>))

<span class="co"># show tables 4 to 7</span>
<span class="kw">list</span>(table_<span class="dv">4</span>, table_<span class="dv">5</span>, table_<span class="dv">6</span>, table_<span class="dv">7</span>)</code></pre></div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="how-to-tally.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="how-to-plot-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
